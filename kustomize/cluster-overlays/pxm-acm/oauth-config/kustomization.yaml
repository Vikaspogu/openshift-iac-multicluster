---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../../bases/oauth-config/

patches:
  - target:
      kind: OAuth
    patch: |-
      - op: add
        path: /spec/identityProviders/1
        value:
          name: ldap-idp
          mappingMethod: claim
          type: LDAP
          ldap:
            attributes:
              id:
              - dn
              email:
              - mail
              name:
              - cn
              preferredUsername:
              - uid
            bindDN: "cn=admin,ou=users,dc=vikaspogu,dc=com"
            bindPassword:
              name: ldap-secret
            insecure: false
            url: "ldaps://lldap.vikaspogu.com"
