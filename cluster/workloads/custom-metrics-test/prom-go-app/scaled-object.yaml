---
apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: prom-scaledobject
  namespace: custom-metrics-test
spec:
  maxReplicaCount: 3
  minReplicaCount: 1
  pollingInterval: 30
  scaleTargetRef:
    name: prom-go-app
  triggers:
    - type: prometheus
      metadata:
        serverAddress: https://thanos-querier.openshift-monitoring.svc.cluster.local:9092
        namespace: custom-metrics-test
        metricName: http_requests_total
        threshold: '5'
        query: sum(rate(promhttp_metric_handler_requests_total{job="prom-go-app"}[1m]))
        authModes: "basic"
